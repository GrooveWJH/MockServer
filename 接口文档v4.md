# 接口文档

## 1. 系统登陆

- 接口地址: `/jk-ivas/third/controller/zsLogin`
- 请求方式: `POST`
- 请求数据类型: `application/json`

**请求参数说明**


| 参数     | 参数类型 | 描述   | 是否必填 |
| -------- | -------- | ------ | -------- |
| account  | String   | 用户名 | 是       |
| password | String   | 密码   | 是       |

**请求示例**
{
"account":"ZSDX001",
"password":"000000"
}

```json

```

**响应状态**


| 状态码 | 说明           | schema    |
| ------ | -------------- | --------- |
| 1      | 成功           | ResResult |
| 2      | 传入参数有误   |           |
| 40     | 未登陆         |           |
| 50     | 未授权         |           |
| -1     | 失败           |           |
| -10    | 服务器内部错误 |           |

**响应参数**


| 参数名称 | 参数说明 | 类型           | schema         |
| -------- | -------- | -------------- | -------------- |
| data     |          | object         |                |
| resCode  |          | integer(int32) | integer(int32) |
| resData  |          | object         |                |
| resMsg   |          | string         |                |

**响应示例**

```json
{
  "resCode": 1,
  "resMsg": "成功",
  "resData": {
    "login": {
      "id": 129,
      "userName": "ZSDX001",
      "account": "ZSDX001",
      "createTime": 1761245456000
    },
    "token": "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxMjkiLCJuYmYiOjE3NjEyNzQyNjgsImlzcyI6Iml2YXNfdGhpcmQiLCJ1c2VyTmFtZSI6IlpTRFgwMDEiLCJ1dWlkIjp7ImxlYXN0U2lnbmlmaWNhbnRCaXRzIjotNzA2MTA2MjcyMzQ0MTc2MDcyMiwibW9zdFNpZ25pZmljYW50Qml0cyI6LTQyMzQ2NTE1NjYxMzU2ODgzODd9LCJpYXQiOjE3NjEyNzQyNjh9.t9TtbuEn-HfeplMPNeR-r41dbnMDTB_YkZ2SZdr5RgQHGIK6txqJRgzUFgLqj_Dq1KO3vxQMS7QWlB5viWPh_g"
  },
  "data": null
}
```

## 2. 无人机上报位置

- 接口地址: `/jk-ivas/third/controller/reportUserData`
- 请求方式: `POST`
- 请求数据类型: `application/x-www-form-urlencoded`

**说明**

调用此接口时，必须在请求头中携带从“1. 系统登陆”接口获取的`token`。 **所有参数均通过 URL Query String 传递。**

**请求头**


| Key   | Value  | 描述               |
| ----- | ------ | ------------------ |
| token | string | 登陆时获取的令牌。 |

**请求参数说明**


| 参数            | 参数类型   | 描述           | 是否必填             |
| --------------- | ---------- | -------------- | -------------------- |
|                 |            |                |                      |
| ivasUserInfoId  | Long       | 人员id         | 否                   |
| userName        | String     | 用户名称       | 否                   |
| roomId          | Long       | 任务id         | 是（传22）           |
| userX           | BigDecimal | 纬度           | 是                   |
| userY           | BigDecimal | 经度           | 是                   |
| userZ           | BigDecimal | 高度           | 是                   |
| azimuth         | Integer    | 方向角         | 是（如果没有则传0）  |
| localTime       | Long       | 时间戳         | 是                   |
| motion          | Integer    | 动/静态        | 0代表静止；1代表移动 |
| validCount      | Integer    | 定位使用卫星数 | 是（如果没有则传0）  |
| deviceCode      | Long       | 设备编码       | 是                   |
| refPositionType | Integer    | 设备类型       | 传0                  |

**请求示例**

一个典型的请求 URL 如下所示 (参数值仅为示例):
`http://<base_url>/jk-ivas/third/controller/reportUserData?deviceCode=1&userX=23.123&userY=113.456&userZ=100.0&azimuth=90&localTime=1725465600000&motion=1&validCount=8&roomId=22&refPositionType=0`


**响应状态**


| 状态码 | 说明         | schema    |
| ------ | ------------ | --------- |
| 200    | OK           | ResResult |
| 201    | Created      |           |
| 401    | Unauthorized |           |
| 403    | Forbidden    |           |
| 404    | Not Found    |           |

**响应参数**


| 参数名称 | 参数说明 | 类型           | schema         |
| -------- | -------- | -------------- | -------------- |
| data     |          | object         |                |
| resCode  |          | integer(int32) | integer(int32) |
| resData  |          | object         |                |
| resMsg   |          | string         |                |

**响应示例**

```json
{
  "data": {},
  "resCode": 0,
  "resData": {},
  "resMsg": "操作成功"
}
```

## 3. 目标识别位置上报

- 接口地址: `/jk-ivas/non/controller/postTarPos`
- 请求方式: `POST`
- 请求数据类型: `application/json`

**说明**

调用此接口时，必须在请求头中携带从“1. 系统登陆”接口获取的`token`。

**请求头**


| Key   | Value  | 描述               |
| ----- | ------ | ------------------ |
| token | string | 登陆时获取的令牌。 |

**请求参数说明**


| 参数      | 参数类型 | 描述                                                                                                    | 是否必填 |
| --------- | -------- | ------------------------------------------------------------------------------------------------------- | -------- |
| timestamp | Integer  | 时间戳                                                                                                  | 是       |
| obj_cnt   | Integer  | 检测到的目标数量                                                                                        | 是       |
| objs      | List     | 目标列表                                                                                                | 是       |
| id        | Integer  | 融合后目标唯一标识                                                                                      | 否       |
| cls       | Integer  | 目标类别（0：人；1：车, 2：飞机）                                                                       | 是       |
| gis       | Double[] | 目标的定位：经度、纬度、海拔高                                                                          | 是       |
| bbox      | Double[] | 框选目标的框信息，依次为： 目标在屏幕中的X坐标、目标在屏幕中的Y坐标、目标在屏幕中的宽、目标在屏幕中的高 | 否       |
| obj_img   | String   | 图片地址                                                                                                | 否       |

**请求示例**

```json
{
  "timestamp": 1725465600,
  "obj_cnt": 1,
  "objs": [
    {
      "id": 1001,
      "cls": 0,
      "gis": [121.473701, 31.230416, 15.2],
      "bbox": [320.5, 240.0, 50.0, 80.0],
      "obj_img": "https://example.com/images/obj_1001.jpg"
    }
  ]
}
```

**响应状态**


| 状态码 | 说明         | schema    |
| ------ | ------------ | --------- |
| 200    | OK           | ResResult |
| 201    | Created      |           |
| 401    | Unauthorized |           |
| 403    | Forbidden    |           |
| 404    | Not Found    |           |

**响应参数**


| 参数名称 | 参数说明 | 类型           | schema         |
| -------- | -------- | -------------- | -------------- |
| data     |          | object         |                |
| resCode  |          | integer(int32) | integer(int32) |
| resData  |          | object         |                |
| resMsg   |          | string         |                |

**响应示例**

```json
{
  "data": {},
  "resCode": 0,
  "resData": {},
  "resMsg": "成功"
}
```

## 4. 室外任务接口

- 接口地址: `/jk-ivas/third/controller/outdoorTask`
- 请求方式: `GET`
- 请求数据类型: `application/json`

**请求示例**

将获取到的token添加到header即可

**响应状态**


| 状态码 | 说明         | schema    |
| ------ | ------------ | --------- |
| 200    | OK           | ResResult |
| 201    | Created      |           |
| 401    | Unauthorized |           |
| 403    | Forbidden    |           |
| 404    | Not Found    |           |

**响应参数**


| 参数名称 | 参数说明 | 类型           | schema         |
| -------- | -------- | -------------- | -------------- |
| code     |          | integer(int32) | integer(int32) |
| msg      |          | string         |                |
| data     |          | object         |                |

**data中包含参数说明**


| 参数    | 参数类型 | 描述                                |
| ------- | -------- | ----------------------------------- |
| mission | Integer  | 任务类型，详见下方任务枚举说明      |
| id      | Integer  | 指定无人机ID (99代表控制所有无人机) |
| lat     | Float    | 辅助量，纬度 (任务类型4需要)        |
| lon     | Float    | 辅助量，经度 (任务类型4需要)        |
| alt     | Float    | 辅助量，高度 (任务类型4需要)        |

**任务枚举说明**

- `1`: 原地起飞5米 (需指定ID，可指定所有无人机)
- `2`: 无人机原地降落 (需指定ID，可指定所有无人机)
- `3`: 返航 (需指定ID，可指定所有无人机)
- `4`: 前往某个指定点 (需指定ID，不能指定所有无人机，需要提供经纬高辅助量)
- `5`: 执行预设多航点任务1 (需指定ID，不能指定所有无人机)
- `6`: 执行预设多航点任务2 (需指定ID，不能指定所有无人机)
- `7`: 执行预设多航点任务3 (需指定ID，不能指定所有无人机)
  **响应示例**

```json
{
  "code": 200,
  "msg": "获取任务成功",
  "data": {
    "mission": 4,
    "id": 101,
    "lon": 121.473701,
    "lat": 31.230416,
    "alt": 50.5
  }
}
```
